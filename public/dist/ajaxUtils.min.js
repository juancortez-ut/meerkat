var ajaxUtils=function(){function e(e,t){$.ajax({method:"GET",url:p.newsletter}).done(function(n){if("object"!=typeof n)return void t("","GET method for "+p.newsletter+" failed.");for(var a={},o=0,r=n.newsletter.length,s=1;s<r;s++){var i=document.createElement("li");$(".carousel-indicators").append(i)}$($("ol li")[o]).addClass("active"),$("#title").append(n.newsletter[o].title),$("#description").append("<span class = 'bold'> Description: </span>"+n.newsletter[o].description),$("#image-newsletter").attr("src","../assets/newsletter/newsletter0?v="+e);var c=document.createElement("a");c.href=n.newsletter[o].image_link,$("#image-newsletter").wrap(c),n.newsletter[o].image_link?$("#image-newsletter").parent()[0].setAttribute("onclick","return true;"):$("#image-newsletter").parent()[0].setAttribute("onclick","return false;"),a.newsletterData=n,a.populatedItems=r,a.message="[GET] newsletter data successful.",t(a)}).fail(function(e){t("","GET method for "+p.newsletter+" failed.")})}function t(e){$.ajax({method:"GET",url:p.calendar}).done(function(t){if("object"!=typeof t)return void e("","GET method for "+p.calendar+" failed.");for(var n,a={},o=0,r=t,s=r.calendar.length,i=!1,c=new Date,u=c.getMonth(),f=c.getDate();i===!1;){calendarHtml=r.calendar[o],$("#event-title").html("<b>Event: </b>"+calendarHtml.event),$("span.title").text(calendarHtml.event);var m=l(calendarHtml.time);m.startTime?($("#event-date").html("<b>Date: </b>"+m.month+" "+m.day+", "+m.year+" at "+m.startTime),n=d(m.month,m.day,m.year,m.startTime),$("span.start").text(n),$("span.end").text(n)):($("#event-date").html("<b>Date: </b>"+m.month+" "+m.day+", "+m.year),n=d(m.month,m.day,m.year,""),$("span.start").text(n),$("span.end").text(n)),m.month<=u&&m.day<f?(r.calendar.splice(0,1),s--):(i=!0,calendarHtml.location?($("#event-location").html("<b>Location: </b>"+calendarHtml.location),$("span.location").text(calendarHtml.location)):$("span.location").text(""),$("#event-link").attr("href",calendarHtml.link),$("span.description").text(calendarHtml.link))}$("#calendar-loader").hide(),a.calendarData=r,a.numCalendarItems=s,e(a)}).fail(function(t){e("","GET method for "+p.calendar+" failed.")})}function n(e){$.ajax({method:"GET",url:p.announcements}).done(function(t){if("object"!=typeof t)return $(".fa-spinner").hide(),void e("GET method for "+p.announcements+" failed.");for(var n=t.announcements,a=t.announcements.length,o=a-1;o>-1;o--)f(n,o,0);$(".announcement-content-container").css({"text-align":"left"}),$(".fa-spinner").hide()}).fail(function(t){$(".announcement-content-container").css({"text-align":"left"}),$(".fa-spinner").hide(),e("GET method for "+p.announcements+" failed.")})}function a(e){$("#announcement-form").submit(function(t){var n=new Date;$(".form-announ #post-announcement").attr("data-login");return $(".form-announ #post-announcement").attr("data-login")?($.ajax({type:"POST",url:p.postAnnouncement,data:{officer:t.target.officer.value,timestamp:n,announcement:t.target.announcement.value}}).done(function(e){console.log("Announcement post successful!"),f(e.announcements,e.announcements.length-1,1)}).fail(function(t){e("Announcement "+p.postAnnouncement+" POST unsuccessful.")}),!1):(alert("Access Denied. How did you get here? You're not supposed to be here!"),e("Announcement post unsuccessful, not authenciated"),!1)})}function o(e){$.ajax({method:"GET",url:p.officers}).done(function(t){if("object"!=typeof t)return void e("GET method for "+p.officers+" failed. Unsupported return type.");for(var n=0,a=t.length;n<a;n++)$("select").append('<option value="'+t[n].name+'">'+t[n].name+"</option>")}).fail(function(t){e("GET method for "+p.officers+" failed.")})}function r(e){localStorage.getItem("credentials")&&$.ajax({method:"GET",url:p.officerLogin+"?credentials="+localStorage.getItem("credentials")}).done(function(t){return void 0===t?void e(p.officerLogin+" endpoint failed"):t.indexOf("404")>=0?void e(p.officerLogin+" endpoint failed"):void("OK"==t&&($(".post-announcement").css({display:"flex"}),$(".announcement-container").css({height:"250px"}),$(".show-login").empty(),$(".form-announ #post-announcement").attr("data-login",!0)))}).fail(function(){e(p.officerLogin+" endpoint failed")})}function s(e,t){$.ajax({type:"POST",url:p.login,data:{username:e.target.name.value,password:e.target.password.value}}).done(function(e){var t=e.uuid;$(".form-announ #post-announcement").attr("data-login",!0),console.log("Login successful with UUID "+t),localStorage.setItem("credentials",t),$(".mes").hide(),$(".status").text("Login successful!").css({color:"#4CAF50"}).show(),$(".post-announcement").show(),$(".announcement-container").css({height:"275px"}),setTimeout(function(){$(".status").hide(),$(".close-modal").click()},1500)}).fail(function(e){$(".status").text("Login unsuccessful.").css({color:"#F44336"}).show(),setTimeout(function(){$(".status").hide(),$(".mes").show()},2500),t("Login unsuccessful.. Error Code: "+JSON.stringify(e))})}function i(e){var t=$("#subscribe-email").val();c(t)?($("#stat").css({color:"green"}),$("#stat").text("Subscription successful!"),$.ajax({type:"POST",url:p.subscribe,data:{name:"new user",email:t,phone:"n/a",category:"SHPE Austin: Newletter Subscription Request",message:"Please add "+t+" to the newsletter.",subscribe:!0}}).done(function(e){console.log("Success!")}).fail(function(t){e(t)}),setTimeout(function(){$("#subscribe-container").css({display:"none"}),$("#newsletter-buttons").show(),$(".fa-archive").show(),$(".fa-envelope").show(),$("#stat").text("Subscribe to our newsletter!"),$("#stat").css({color:"black"})},2500)):($("#stat").css({color:"red"}),$("#stat").text("Invalid e-mail."))}function c(e){var t=/(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/;return t.test(e)}function l(e){var t=[],n=e.substring(0,e.indexOf("-"));e=e.substring(e.indexOf("-")+1,e.length);var a=e.substring(0,e.indexOf("-"));if(a=u(a),e=e.substring(e.indexOf("-")+1,e.length),day=e.substring(0,2),e.length>2){var o=e.substring(3,e.length),r=o.substring(0,5),s=parseInt(r);if(s>=12){if(s>12){var i=r.substring(2,r.length),c=parseInt(r.substring(0,2))-12;c/10<1&&(c=c.pad(2)),r=c+i}s="PM"}else s="AM";t.startTime=r+" "+s}else t.startTime="";return t.month=a,t.day=day,t.year=n,t}function u(e){switch(e=parseInt(e.replace(/^0+/,""))){case 1:return"January";case 2:return"February";case 3:return"March";case 4:return"April";case 5:return"May";case 6:return"June";case 7:return"July";case 8:return"August";case 9:return"September";case 10:return"October";case 11:return"November";case 12:return"December";default:return"Invalid Month"}}function d(e,t,n,a){return""===a&&(a="12:00 PM"),e=m.indexOf(e)+1,e/10<1&&(e=e.pad(2)),e+"/"+t+"/"+n+" "+a}function f(e,t,n){"undefined"==typeof t&&(t=e.length-1);var a='<p class="officer-post"> <span class="post-info"></span> <span class="post-content"></span></p>',o=e[t].officer,r=e[t].timestamp,s=e[t].announcement,i=new Date(r),c=i.toLocaleDateString(),l=i.toLocaleTimeString(),u=o+" ("+c+" @ "+l+")",d=$(a).find(".post-info")[0];$(d).text(u+" ");var f,m=$(a).find(".post-content")[0];if(new RegExp("([a-zA-Z0-9]+://)?([a-zA-Z0-9_]+:[a-zA-Z0-9_]+@)?([a-zA-Z0-9.-]+\\.[A-Za-z]{2,4})(:[0-9]+)?(/.*)?").test(s))for(var p=s.split(" "),g=0,h=p.length;g<h;g++)new RegExp("([a-zA-Z0-9]+://)?([a-zA-Z0-9_]+:[a-zA-Z0-9_]+@)?([a-zA-Z0-9.-]+\\.[A-Za-z]{2,4})(:[0-9]+)?(/.*)?").test(p[g])&&(f=document.createElement("a"),f.setAttribute("href",p[g]),f.text="(Attached link)");$(m).html(s+" "),$(m).append(f);var b='<p class="officer-post">',v=b;v=$(v).append(d),v=$(v).append(m),0===n?$(".announcement-content-container").append(v):1===n&&$(".announcement-content-container").prepend(v)}var m=["January","February","March","April","May","June","July","August","September","October","November","December"],p={newsletter:"/data/newsletterdata",calendar:"/data/calendardata",announcements:"/data/announcements",officers:"/data/officerlist",officerLogin:"/data/officerlogin",postAnnouncement:"/update/announcements",login:"/authentication/login",subscribe:"/communication/contact"};return{getNewsletterData:e,getCalendarData:t,getAnnouncements:n,postAnnouncement:a,getOfficers:o,getAuthentication:r,login:s,subscribe:i,_parseCalendarTime:l,_convertToDateFormat:d}}();