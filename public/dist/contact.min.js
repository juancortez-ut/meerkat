$(document).ready(function(){function e(e){e==-1?$("#submit-button").text("Failed").css({background:"#D8000C"}):1==e&&$("#submit-button").text("Success").css({background:"green"}),setTimeout(function(){$("#submit-button").text("Send it").css({background:"#0137A2"})},2500)}function t(e,t){console.log("Request complete");var n=".submit-request";$(n).html();var o=2e3;return e?$(n).text("Failed, try Again.").css({background:"#D8000C"}):($(n).text("Success! Please check your email to verify subscription!").css({background:"green"}),o=4e3),setTimeout(function(){var e=$(n).text();$(n).text("Submit").css({background:"#0137A2"}),"Success!"===e&&modal.close()},o),t&&location.reload(),!1}Chat.initialize(),$("#chat").submit(function(e){return Chat.sendMessage(e),!1}),$("#chat-header i").click(function(){$(".content-container").toggle(),$(this).hasClass("fa-angle-double-up")?($("#chat-container").css({height:"368px"}),$(this).removeClass("fa-angle-double-up").addClass("fa-angle-double-down")):($("#chat-container").css({height:"30px"}),$(this).removeClass("fa-angle-double-down").addClass("fa-angle-double-up"))}),$("#chat-header i").click(),$("#email").submit(function(t){return $.ajax({type:"POST",url:"/communication/contact",data:{name:t.target.name.value,email:t.target.email.value,phone:t.target.phone.value,category:t.target.category.value,message:t.target.message.value}}).done(function(t){console.log("Success!"),e(1)}).fail(function(t){console.error("Unsuccessful. Error Code:"),console.log(JSON.stringify(t,null,4)),e(-1)}),!1});var n=$('<div id="overlay"></div>'),o=$('<div id="modal"></div>'),a=$('<a id="close" href="#">close</a>'),i=$('<div id="modal-content"></div>');o.hide(),n.hide(),o.append(i,a),$(".contact-container").append(n,o),modal.initialize({$overlay:$("#overlay"),$modal:$("#modal"),$close:$("#close"),$content:$("#modal-content")}),$(".subscribe-container").click(function(){var e=400,n=500;window_height=$(window).height(),window_width=$(window).width(),e=window_height<e?window_height-50:e,n=window_width<n?window_width-50:n,$("#modal").css({background:"white"});var o='<h1>SHPE Austin Newsletter</h1><form><div class="form-group row"><label for="first_name" class="col-xs-2 col-form-label">First Name:</label><div class="col-xs-10">   <input class="form-control" type="text" placeholder="First Name" name="first_name" id="first_name"></div></div><div class="form-group row"><label for="last_name" class="col-xs-2 col-form-label">Last Name:</label><div class="col-xs-10">   <input class="form-control" type="text" placeholder="Last Name" name="last_name" id="last_name"></div></div><div class="form-group row"><label for="email" class="col-xs-2 col-form-label">Email:</label><div class="col-xs-10">   <input class="form-control" type="email" placeholder="E-Mail Address" name="email" id="email"></div></div><div class="button-container"><button type="submit" class="btn btn-primary submit-request">Submit</button></div></form>';modal.open({content:$(o),width:n+"px",height:e+"px",align:"center"}),$(".submit-request").bind("click",function(e){var n=(e.target.form.first_name.value,e.target.form.last_name.value,e.target.form.email.value),o=$(".mailchimp-subscribe").attr("data-mailchimp");return $.ajax({type:"POST",url:"/communication/mailchimp/lists/"+o+"/subscribe",data:{email:n}}).done(function(e){t(!1,!1),console.log(n+" was successfully subscribed!")}).fail(function(e){return 200===e.status?void t(!1,!1):(t(!0,!1),void console.error(e))}),!1})}),a.click(function(e){e.preventDefault(),modal.close()})});var Chat=function(){function e(e){return e.charAt(0).toUpperCase()+e.slice(1)}function t(){var e=new Date,t=e.getTime()+6e4*e.getTimezoneOffset(),n=new Date(t+-18e6);return n.toLocaleTimeString()}var n,o,a={},i=0;return a.initialize=function(){n=io(),this.activateSockets()},a.activateSockets=function(){n.on("chat message",function(e){$("#chat-content").append("<div class='msgln'> <span class='bold'>"+e.name+" ("+e.time+"): </span>"+e.message+"</div>"),$("#chat-content").scrollTop($("#chat-content")[0].scrollHeight)}),n.on("usersOnline",function(e){i=e,console.log("There "+(i>1?"are "+i+" users":"is one user")+" online, including yourself.")}),n.on("new-user",function(e){e!=o&&void 0!==o&&(console.log(e+" joined the chat!"),$("#chat-content").append("<div class='msgln new-user'>"+e+" just joined the chat!</div>"))})},a.getSocket=function(){return n?n:(console.error("Socket has not yet been initialized"),null)},a.sendMessage=function(a){if(!o)return o=$("#chat-message").val(),$("#chat-message").val(""),$("p#name-prompt").remove(),o=e(o),n.emit("joined-chat",o),void $("#chat-content").append("<div class='msgln italic'> Welcome "+o+"! There "+(i>1?"are "+i+" users":" is one user")+" online, including yourself.</div>");var s={message:$("#chat-message").val(),name:o,time:t()};return n?n.emit("chat message",s):(console.error("socket.io not connected. Make sure to initialize socket.io!"),$("#chat-content").append("<span class='error'>Sorry, unable to send messages at the time.</span></br>")),$("#chat-message").val(""),!1},a}(),modal=function(){var e,t,n,o,a={};return a.initialize=function(a){console.log("Initializing modal..."),e=a.$content,t=a.$close,n=a.$overlay,o=a.$modal},a.center=function(){var e,t;e=Math.max($(window).height()-o.outerHeight(),0)/2,t=Math.max($(window).width()-o.outerWidth(),0)/2,o.css({top:e+$(window).scrollTop(),left:t+$(window).scrollLeft()})},a.open=function(t){e.empty().append(t.content),o.css({width:t.width-10||"auto",height:t.height-10||"auto","text-align":t.align}),e.css({width:t.width||"auto",height:t.height||"auto"}),a.center(),$(window).bind("resize.modal",a.center),o.show(),n.show()},a.close=function(){o.hide(),n.hide(),e.empty(),$(window).unbind("resize.modal")},$(document).keydown(function(e){27==e.keyCode&&$("#close").click()}),a}();