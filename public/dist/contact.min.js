"use strict";$(document).ready(function(){function e(e){e==-1?(modal.open({content:"<b>Oh no!</b></br>Email wasn't sent...sorry, try again :(",width:width+"px",height:height+"px",align:"center"}),$("#submit-button").text("Failed").css({background:"#D8000C"})):1==e&&(modal.open({content:"<b>E-mail sent!</b></br>We will answer as soon as we can!",width:"250px",height:"100px",align:"center"}),console.log("open modal"),$("#submit-button").text("Success").css({background:"green"})),setTimeout(function(){$("#submit-button").text("Send it").css({background:"#0137A2"})},1e4)}function t(e,t){console.log("Request complete");var a=".submit-request";$(a).html();var o=2e3;return e?$(a).text("Failed, try Again.").css({background:"#D8000C"}):$(a).text("Success!").css({background:"green"}),setTimeout(function(){var e=$(a).text();$(a).text("Submit").css({background:"#0137A2"}),"Success!"===e&&modal.close()},o),t&&location.reload(),!1}Chat.initialize(),$("#chat").submit(function(e){return Chat.sendMessage(e),!1}),$("#chat-header i").click(function(){$(".content-container").toggle(),$(this).hasClass("fa-angle-double-up")?($("#chat-container").css({height:"368px"}),$(this).removeClass("fa-angle-double-up").addClass("fa-angle-double-down")):($("#chat-container").css({height:"30px"}),$(this).removeClass("fa-angle-double-down").addClass("fa-angle-double-up"))}),$("#chat-header i").click(),$(".toggle button").click(function(e){var t=e.currentTarget.id;"physical-toggle"===t?($("#email-toggle").removeClass("active"),$("#email-toggle").addClass("inactive"),$("#physical-toggle").removeClass("inactive"),$("#physical-toggle").addClass("active"),$(".form-email").css({display:"none"}),$(".envelope-container").css({display:"flex"})):($("#physical-toggle").removeClass("active"),$("#physical-toggle").addClass("inactive"),$("#email-toggle").removeClass("inactive"),$("#email-toggle").addClass("active"),$(".envelope-container").css({display:"none"}),$(".form-email").show())}),$("#email").submit(function(t){return $.ajax({type:"POST",url:"/communication/contact",data:{name:t.target.name.value,email:t.target.email.value,phone:t.target.phone.value,category:t.target.category.value,message:t.target.message.value}}).done(function(t){console.log("Success!"),e(1)}).fail(function(t){console.error("Unsuccessful. Error Code:"),console.log(JSON.stringify(t,null,4)),e(-1)}),!1});var a=$('<div id="overlay"></div>'),o=$('<div id="modal"></div>'),n=$('<a id="close" href="#">close</a>'),i=$('<div id="modal-content"></div>');o.hide(),a.hide(),o.append(i,n),$(".contact-container").append(a,o),modal.initialize({$overlay:$("#overlay"),$modal:$("#modal"),$close:$("#close"),$content:$("#modal-content")}),$(".subscribe-container").click(function(){var e=400,a=500,o=$(window).height(),n=$(window).width();e=o<e?o-50:e,a=n<a?n-50:a,$("#modal").css({background:"white"});var i='<h2>Subscribe to SHPE Newsletter</h2><form><div class="form-group row"><label for="first_name" class="col-xs-2 col-form-label">First Name:</label><div class="col-xs-10">   <input class="form-control" type="text" placeholder="First Name" name="first_name" id="first_name"></div></div><div class="form-group row"><label for="last_name" class="col-xs-2 col-form-label">Last Name:</label><div class="col-xs-10">   <input class="form-control" type="text" placeholder="Last Name" name="last_name" id="last_name"></div></div><div class="form-group row"><label for="email" class="col-xs-2 col-form-label">Email:</label><div class="col-xs-10">   <input class="form-control" type="email" placeholder="E-Mail Address" name="email" id="email"></div></div><div class="button-container"><button type="submit" class="btn btn-primary submit-request">Subscribe</button></div></form>';modal.open({content:$(i),width:a+"px",height:e+"px",align:"center"}),$(".submit-request").bind("click",function(e){var a=(e.target.form.first_name.value,e.target.form.last_name.value,e.target.form.email.value),o=$(".mailchimp-subscribe").attr("data-mailchimp"),n=".submit-request";return $(n).html('<i class="fa fa-cog fa-spin fa-3x fa-fw"></i>'),$.ajax({type:"POST",url:"/communication/mailchimp/lists/"+o+"/subscribe",data:{email:a}}).done(function(e){t(!1,!1),console.log(a+" was successfully subscribed!")}).fail(function(e){return 200===e.status?void t(!1,!1):(t(!0,!1),void console.error(e))}),!1})}),n.click(function(e){e.preventDefault(),modal.close()})});var Chat=function(){function e(e){return e.charAt(0).toUpperCase()+e.slice(1)}function t(){var e=new Date,t=e.getTime()+6e4*e.getTimezoneOffset(),a=new Date(t+-18e6);return a.toLocaleTimeString()}var a,o,n={},i=0;return n.initialize=function(){a=io(),this.activateSockets()},n.activateSockets=function(){a.on("chat message",function(e){$("#chat-content").append("<div class='msgln'> <span class='bold'>"+e.name+" ("+e.time+"): </span>"+e.message+"</div>"),$("#chat-content").scrollTop($("#chat-content")[0].scrollHeight)}),a.on("usersOnline",function(e){i=e,console.log("There "+(i>1?"are "+i+" users":"is one user")+" online, including yourself.")}),a.on("new-user",function(e){e!=o&&void 0!==o&&(console.log(e+" joined the chat!"),$("#chat-content").append("<div class='msgln new-user'>"+e+" just joined the chat!</div>"))})},n.getSocket=function(){return a?a:(console.error("Socket has not yet been initialized"),null)},n.sendMessage=function(n){if(!o)return o=$("#chat-message").val(),$("#chat-message").val(""),$("p#name-prompt").remove(),o=e(o),a.emit("joined-chat",o),void $("#chat-content").append("<div class='msgln italic'> Welcome "+o+"! There "+(i>1?"are "+i+" users":" is one user")+" online, including yourself.</div>");var s={message:$("#chat-message").val(),name:o,time:t()};return a?a.emit("chat message",s):(console.error("socket.io not connected. Make sure to initialize socket.io!"),$("#chat-content").append("<span class='error'>Sorry, unable to send messages at the time.</span></br>")),$("#chat-message").val(""),!1},n}(),modal=function(){var e,t,a,o,n={};return n.initialize=function(n){console.log("Initializing modal..."),e=n.$content,t=n.$close,a=n.$overlay,o=n.$modal},n.center=function(){var e,t;e=Math.max($(window).height()-o.outerHeight(),0)/2,t=Math.max($(window).width()-o.outerWidth(),0)/2,o.css({top:e+$(window).scrollTop(),left:t+$(window).scrollLeft()})},n.open=function(t){e.empty().append(t.content),o.css({width:t.width-10||"auto",height:t.height-10||"auto","text-align":t.align}),e.css({width:t.width||"auto",height:t.height||"auto"}),n.center(),$(window).bind("resize.modal",n.center),o.show(),a.show()},n.close=function(){o.hide(),a.hide(),e.empty(),$(window).unbind("resize.modal")},$(document).keydown(function(e){27==e.keyCode&&$("#close").click()}),n}();