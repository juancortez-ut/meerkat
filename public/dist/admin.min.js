$(document).ready(function(){function t(t){var e="_hiddenCopyText_",n=document.createElement("textarea");n.style.position="absolute",n.style.left="-9999px",n.style.top="1200px",n.id=e,document.body.appendChild(n),n.textContent=t.textContent;var o=document.activeElement;n.focus(),n.setSelectionRange(0,n.value.length);var a;try{a=document.execCommand("copy")}catch(c){a=!1}return o&&"function"==typeof o.focus&&o.focus(),n.textContent="",a}$("#data-newsletterdata").attr("disabled",!0),$(".submit-request").click(function(t){function e(t,e){return console.log("Request complete"),$(c).html(),t?$(c).text("Failure").css({background:"#D8000C"}):$(c).text("Success!").css({background:"green"}),setTimeout(function(){$(c).text("Submit").css({background:"#0137A2"})},2e3),e&&location.reload(),!1}function n(t){for(var e=document.getElementsByName(t),n=0;n<e.length;n++)if(e[n].checked)return e[n].value}var o=t&&t.target&&t.target.form&&t.target.form.children||null,a=$(this).attr("data-request"),c=this,s=[];if(o&&o.length>1){var i=$.map(o,function(t,e){if($(t).is(".form-check"))return[t]});i.filter(function(t){return!!$(t).find(".form-check-input").is(":checked")&&(s.push($(t).find(".form-check-input").val()),!0)})}var l=0;if(s.length>0&&"delete"==a&&($(this).html('<i class="fa fa-cog fa-spin fa-3x fa-fw"></i>'),s.forEach(function(t){$.ajax({method:"DELETE",url:"/data/"+t}).done(function(e){"OK"===e&&console.log(t+" was successfully cleared!")}).fail(function(e){console.error(t+" was unsuccessfully cleared."),console.error(e)}).always(function(){l++,l==s.length&&e(!1,!0)})})),"update"==a){$(this).html('<i class="fa fa-cog fa-spin fa-3x fa-fw"></i>');var r,u=n("updateoptions"),d=$("#data-update").val(),f=!1;try{var p=JSON.parse(d);r=typeof p}catch(h){f=!0}d=f&&"object"!==r?null:d,$.ajax({method:"PUT",url:"/data/"+u,dataType:"json",contentType:"application/json",data:d}).done(function(t){console.log(t),"OK"===t&&(e(!1,!1),console.log(u+" was successfully updated!"))}).fail(function(t){return 200===t.status?void e(!1,!1):(e(!0,!1),console.error(u+" was unsuccessfully updated."),void console.error(t))}).always(function(){})}if("view"==a){$(this).html('<i class="fa fa-cog fa-spin fa-3x fa-fw"></i>');var m=n("keyoptions");console.log(m),$.ajax({method:"GET",url:"/data/"+m}).done(function(t){$(".json-container .output-container").show(),$(".json-container .output-container i").show(),$("#hidden-output").text(JSON.stringify(t)),$(".output").text(JSON.stringify(t,null,4)),$("html, body").animate({scrollTop:$(".json-container").offset().top-90},1e3),e(!1,!1)}).fail(function(t){e(!0,!1),console.error("Unable to find "+m+". Error: "+JSON.stringify(t))}).always(function(){})}return!1}),$("input[type=radio][name=updateoptions]").change(function(t){var e=t.target.value;switch(e){case"calendar":$(".change-data").hide(),$(".update-description").text("Will send a REST call to the Google Calendar API.");break;case"newsletterdata":$(".change-data").hide(),$(".update-description").text("External call to newsletter page. Close new page when complete.");break;default:$(".update-description").text(""),$(".change-data").show()}}),document.getElementById("copy-text").addEventListener("click",function(){var e=t(document.getElementById("hidden-output"));$("html, body").animate({scrollTop:$(".json-container").offset().top-90},1);var n=e?"Successfully copied!":"Copy unsuccessful!",o=$(".copy-status");e?o.css({color:"green"}):o.css({color:"red"}),$(".copy-status").text(n).show(),setTimeout(function(){o.hide()},2e3)})});