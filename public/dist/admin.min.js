$(document).ready(function(){function t(t){var e="_hiddenCopyText_",o=document.createElement("textarea");o.style.position="absolute",o.style.left="-9999px",o.style.top="1200px",o.id=e,document.body.appendChild(o),o.textContent=t.textContent;var n=document.activeElement;o.focus(),o.setSelectionRange(0,o.value.length);var a;try{a=document.execCommand("copy")}catch(c){a=!1}return n&&"function"==typeof n.focus&&n.focus(),o.textContent="",a}$(".submit-request").click(function(t){function e(t,e){return console.log("Request complete"),$(c).html(),t?$(c).text("Failure"):$(c).text("Success!"),setTimeout(function(){$(c).text("Submit")},2e3),e&&location.reload(),!1}function o(t){for(var e=document.getElementsByName(t),o=0;o<e.length;o++)if(e[o].checked)return e[o].value}var n=t&&t.target&&t.target.form&&t.target.form.children||null,a=$(this).attr("data-request"),c=this,s=[];if(n&&n.length>1){var i=$.map(n,function(t,e){if($(t).is(".form-check"))return[t]});i.filter(function(t){return!!$(t).find(".form-check-input").is(":checked")&&(s.push($(t).find(".form-check-input").val()),!0)})}var l=0;if(s.length>0&&"delete"==a&&($(this).html('<i class="fa fa-cog fa-spin fa-3x fa-fw"></i>'),s.forEach(function(t){$.ajax({method:"DELETE",url:"/data/"+t}).done(function(e){"OK"===e&&console.log(t+" was successfully cleared!")}).fail(function(e){console.error(t+" was unsuccessfully cleared."),console.error(e)}).always(function(){l++,l==s.length&&e(!1,!0)})})),"update"==a){$(this).html('<i class="fa fa-cog fa-spin fa-3x fa-fw"></i>');var r=o("updateoptions");if("newsletterdata"==r){var u=window.location.protocol+"//"+window.location.host+"/";return window.open(u+"update/newsletterload"),l++,console.info("Don't forget to move the newsletter* images to public/assets/newsletter"),void(l==s.length&&e(!1,!0))}var d,f=$("#data-update").val(),p=!1;try{var h=JSON.parse(f);d=typeof h}catch(m){p=!0}f=p&&"object"!==d?null:f,$.ajax({method:"PUT",url:"/data/"+r,dataType:"json",contentType:"application/json",data:f}).done(function(t){console.log(t),"OK"===t&&(e(!1,!1),console.log(r+" was successfully updated!"))}).fail(function(t){return 200===t.status?void e(!1,!1):(e(!0,!1),console.error(r+" was unsuccessfully updated."),void console.error(t))}).always(function(){})}if("view"==a){$(this).html('<i class="fa fa-cog fa-spin fa-3x fa-fw"></i>');var g=o("keyoptions");console.log(g),$.ajax({method:"GET",url:"/data/"+g}).done(function(t){$(".json-container .output-container").show(),$(".json-container .output-container i").show(),$("#hidden-output").text(JSON.stringify(t)),$(".output").text(JSON.stringify(t,null,4)),$("html, body").animate({scrollTop:$(".json-container").offset().top-90},1e3),e(!1,!1)}).fail(function(t){e(!0,!1),console.error("Unable to find "+g+". Error: "+JSON.stringify(t))}).always(function(){})}return!1}),$("input[type=radio][name=updateoptions]").change(function(t){var e=t.target.value;switch(e){case"calendar":$(".change-data").hide(),$(".update-description").text("Will send a REST call to the Google Calendar API.");break;case"newsletterdata":$(".change-data").hide(),$(".update-description").text("External call to newsletter page. Close new page when complete.");break;default:$(".update-description").text(""),$(".change-data").show()}}),document.getElementById("copy-text").addEventListener("click",function(){var e=t(document.getElementById("hidden-output"));$("html, body").animate({scrollTop:$(".json-container").offset().top-90},1);var o=e?"Successfully copied!":"Copy unsuccessful!",n=$(".copy-status");e?n.css({color:"green"}):n.css({color:"red"}),$(".copy-status").text(o).show(),setTimeout(function(){n.hide()},2e3)})});