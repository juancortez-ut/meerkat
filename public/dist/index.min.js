$(document).ready(function(){function e(e,t,n){var a='<p class="officer-post"> <span class="post-info"></span> <span class="post-content"></span></p>',r=e[t].officer,s=e[t].timestamp,o=e[t].announcement,l=new Date(s),i=l.toLocaleDateString(),c=l.toLocaleTimeString(),u=r+" ("+i+" @ "+c+")",d=$(a).find(".post-info")[0];$(d).text(u+" ");var m=$(a).find(".post-content")[0];new RegExp("([a-zA-Z0-9]+://)?([a-zA-Z0-9_]+:[a-zA-Z0-9_]+@)?([a-zA-Z0-9.-]+\\.[A-Za-z]{2,4})(:[0-9]+)?(/.*)?").test(o)&&console.log("Contains URL"),$(m).text(o);var p='<p class="officer-post">',f=p;f=$(f).append(d),f=$(f).append(m),0===n?$(".announcement-content-container").append(f):1===n&&$(".announcement-content-container").prepend(f)}function t(e,t,n,a){return""==a&&(a="12:00 PM"),e=f.indexOf(e)+1,1>e/10&&(e=e.pad(2)),e+"/"+t+"/"+n+" "+a}function n(e){var t=[],n=e.substring(0,e.indexOf("-"));e=e.substring(e.indexOf("-")+1,e.length);var r=e.substring(0,e.indexOf("-"));if(r=a(r),e=e.substring(e.indexOf("-")+1,e.length),day=e.substring(0,2),e.length>2){var s=e.substring(3,e.length),o=s.substring(0,5),l=parseInt(o);if(l>=12){if(l>12){var i=o.substring(2,o.length),c=parseInt(o.substring(0,2))-12;1>c/10&&(c=c.pad(2)),o=c+i}l="PM"}else l="AM";t.startTime=o+" "+l}else t.startTime="";return t.month=r,t.day=day,t.year=n,t}function a(e){switch(e=parseInt(e.replace(/^0+/,""))){case 1:return"January";case 2:return"February";case 3:return"March";case 4:return"April";case 5:return"May";case 6:return"June";case 7:return"July";case 8:return"August";case 9:return"September";case 10:return"October";case 11:return"November";case 12:return"December";default:return"Invalid Month"}}function r(){$("#title").empty(),$("#description").empty(),c>i&&($($("ol li")[i]).addClass("active"),$("#title").append(s.newsletter[i].title),$("#description").append("<span class = 'bold'> Description: </span>"+s.newsletter[i].description),$("#image-newsletter").attr("src","../assets/newsletter/newsletter"+i),$("#image-newsletter").parent()[0].setAttribute("href",s.newsletter[i].image_link),s.newsletter[i].image_link?$("#image-newsletter").parent()[0].setAttribute("onclick","return true;"):$("#image-newsletter").parent()[0].setAttribute("onclick","return false;"))}var s,o,l,i=0,c=0,u=0,d=0,m=!1,p=setInterval(function(e){$("#next-newsletter").click()},5e3);$.ajax({method:"GET",url:"/newsletterdata"}).done(function(e){s=e,c=e.newsletter.length;for(var t=1;c>t;t++){var n=document.createElement("li");$(".carousel-indicators").append(n)}$($("ol li")[i]).addClass("active"),$("#title").append(e.newsletter[i].title),$("#description").append("<span class = 'bold'> Description: </span>"+e.newsletter[i].description),$("#image-newsletter").attr("src","../assets/newsletter/newsletter0");var a=document.createElement("a");a.href=e.newsletter[i].image_link,$("#image-newsletter").wrap(a),e.newsletter[i].image_link?$("#image-newsletter").parent()[0].setAttribute("onclick","return true;"):$("#image-newsletter").parent()[0].setAttribute("onclick","return false;")}).fail(function(e){console.error("GET method for /newsletterdata failed.")}),$.ajax({method:"GET",url:"/calendardata"}).done(function(e){o=e,u=o.calendar.length;var a=!1,r=new Date;for(r.getMonth(),r.getDate();a===!1;){calendarHtml=o.calendar[d],$("#event-title").html("<b>Event: </b>"+calendarHtml.event),$("span.title").text(calendarHtml.event);var s=n(calendarHtml.time);if(s.startTime){$("#event-date").html("<b>Date: </b>"+s.month+" "+s.day+", "+s.year+" at "+s.startTime);var l=t(s.month,s.day,s.year,s.startTime);$("span.start").text(l),$("span.end").text(l)}else{$("#event-date").html("<b>Date: </b>"+s.month+" "+s.day+", "+s.year);var l=t(s.month,s.day,s.year,"");$("span.start").text(l),$("span.end").text(l)}s.day<r.getDate()?(o.calendar.splice(0,1),u--):(a=!0,calendarHtml.location?($("#event-location").html("<b>Location: </b>"+calendarHtml.location),$("span.location").text(calendarHtml.location)):$("span.location").text(""),$("#event-link").attr("href",calendarHtml.link),$("span.description").text(calendarHtml.link))}}),$.ajax({method:"GET",url:"/announcements"}).done(function(t){var n=t.announcements;l=t.announcements.length;for(var a=l-1;a>-1;a--)e(n,a,0);console.log("Success!!"),$(".announcement-content-container").css({"text-align":"left"}),$(".fa-spinner").hide()}).fail(function(e){$(".announcement-content-container").css({"text-align":"left"}),$(".fa-spinner").hide(),console.error("GET method for /announcements failed.")}),$(".cal-button").on("click",function(e){$(e.currentTarget).hasClass("fa-angle-double-right")?d=(d+1)%u:(d--,0>d&&(d=u-1)),$(".fa-calendar").toggleClass("dark-shpe-blue mid-blue"),calendarHtml=o.calendar[d],$("#event-title").html("<b>Event: </b>"+calendarHtml.event),$("span.title").text(calendarHtml.event);var a=n(calendarHtml.time);if(a.startTime){$("#event-date").html("<b>Date: </b>"+a.month+" "+a.day+", "+a.year+" at "+a.startTime);var r=t(a.month,a.day,a.year,a.startTime);$("span.start").text(r),$("span.end").text(r)}else{$("#event-date").html("<b>Date: </b>"+a.month+" "+a.day+", "+a.year);var r=t(a.month,a.day,a.year,a.startTime,"");$("span.start").text(r),$("span.end").text(r)}calendarHtml.location?($("#event-location").html("<b>Location: </b>"+calendarHtml.location),$("span.location").text(calendarHtml.location)):($("#event-location").html(""),$("span.location").text("")),$("#event-link").attr("href",calendarHtml.link),$("span.description").text(calendarHtml.link)});var f=["January","February","March","April","May","June","July","August","September","October","November","December"];$("#prev-newsletter").click(function(e){e.originalEvent&&clearInterval(p),$($("ol li")[i]).removeClass("active"),0===i?i=c-1:i--,r()}),$("#next-newsletter").click(function(e){e.originalEvent&&clearInterval(p),$($("ol li")[i]).removeClass("active"),i=(i+1)%c,r()});var g=/Android|iPhone|iPad|iPod/i.test(navigator.userAgent);g&&$(".show-login").empty(),$("#login-form").submit(function(e){return $.ajax({type:"POST",url:"/login",data:{username:e.target.name.value,password:e.target.password.value}}).done(function(e){console.log("Login successful!"),$(".status").text("Login successful!").css({color:"#4CAF50"}).show(),$(".post-announcement").show(),$(".announcement-container").css({height:"315px"}),m=!0,setTimeout(function(){$(".status").hide(),$(".close-modal").click()},1500)}).fail(function(e){$(".status").text("Login unsuccessful.").css({color:"#F44336"}).show(),setTimeout(function(){$(".status").hide()},2500),console.error("Login unsuccessful.. Error Code: "+JSON.stringify(e))}),!1}),$("#announcement-form").submit(function(t){var n=new Date;return m?($.ajax({type:"POST",url:"/announcements",data:{officer:t.target.officer.value,timestamp:n,announcement:t.target.announcement.value}}).done(function(t){console.log("Announcement post successful!"),e(t.announcements,l,1),l++}).fail(function(e){console.error("Announcement post unsuccessful.")}),!1):(alert("Access Denied. How did you get here? You're not supposed to be here!"),!1)}),Number.prototype.pad=function(e){return new Array(e).join("0").slice(-1*(e||2))+this}});