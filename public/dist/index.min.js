"use strict";$(document).ready(function(){var e,n,t=io(),o=0,a=0;t.emit("revision","Get revision number from backend."),t.on("revision",function(n){console.log("Revision is: "+n),e=n}),"/"==window.location.pathname&&(ajaxUtils.getCalendarData(function(e,t){return t?void console.error(t):(n=e.calendarData,o=n.length,$(".fa-angle-double-right").click(),void $(".fa-angle-double-left").click())}),ajaxUtils.getAnnouncements(function(e){e&&console.error(e)}),ajaxUtils.getOfficers(function(e){e&&console.error(e)}),ajaxUtils.getAuthentication(function(e){e&&console.error(e)})),ajaxUtils.postAnnouncement(function(e){e&&console.error(e)}),$("#login-form").submit(function(e){return ajaxUtils.login.call(this,e,function(e){e&&console.error(e)}),!1}),$(".cal-button").on("click",function(e){$(e.currentTarget).hasClass("fa-angle-double-right")?a=(a+1)%o:(a--,a<0&&(a=o-1)),$(".fa-calendar").toggleClass("dark-shpe-blue mid-blue");var t=n[a];$("#event-title").html("<b>Event: </b>"+t.event),$("span.title").text(t.event);var i,r=ajaxUtils._parseCalendarTime(t.time);r.startTime?($("#event-date").html("<b>Date: </b>"+r.month+" "+r.day+", "+r.year+" at "+r.startTime),i=ajaxUtils._convertToDateFormat(r.month,r.day,r.year,r.startTime),$("span.start").text(i),$("span.end").text(i)):($("#event-date").html("<b>Date: </b>"+r.month+" "+r.day+", "+r.year),i=ajaxUtils._convertToDateFormat(r.month,r.day,r.year,r.startTime,""),$("span.start").text(i),$("span.end").text(i)),t.location?($("#event-location").html("<b>Location: </b>"+t.location),$("span.location").text(t.location)):($("#event-location").html(""),$("span.location").text("")),$("#event-link").attr("href",t.link),$("span.description").text(t.link)});var i=/Android|iPhone|iPad|iPod/i.test(navigator.userAgent);i&&$(".show-login").empty(),Number.prototype.pad=function(e){return new Array(e).join("0").slice((e||2)*-1)+this},$(document).keydown(function(e){13==e.keyCode?$("#subscribe-container").is(":visible")&&$("#subscribe-email").is(":focus")&&$(".fa-envelope-o").click():27==e.keyCode&&$("#subscribe-container").is(":visible")&&$("#close-subscribe").click()})});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},ajaxUtils=function(){function e(e){$.ajax({method:"GET",url:m.calendar}).done(function(n){if("object"!=("undefined"==typeof n?"undefined":_typeof(n)))return void e("","GET method for "+m.calendar+" failed.");var t=new Date;t=t.getTime(),n.calendar=n.calendar.filter(function(e){var n=new Date(e.time).getTime();return n>=t});var o,a={},i=n.calendar;i.forEach(function(e){$("#event-title").html("<b>Event: </b>"+e.event),$("span.title").text(e.event);var n=c(e.time);n.startTime?($("#event-date").html("<b>Date: </b>"+n.month+" "+n.day+", "+n.year+" at "+n.startTime),o=l(n.month,n.day,n.year,n.startTime),$("span.start").text(o),$("span.end").text(o)):($("#event-date").html("<b>Date: </b>"+n.month+" "+n.day+", "+n.year),o=l(n.month,n.day,n.year,""),$("span.start").text(o),$("span.end").text(o)),e.location?($("#event-location").html("<b>Location: </b>"+e.location),$("span.location").text(e.location)):$("span.location").text(""),$("#event-link").attr("href",e.link),$("span.description").text(e.link)}),$("#calendar-loader").hide(),a.calendarData=i,e(a)}).fail(function(n){e("","GET method for "+m.calendar+" failed.")})}function n(e){$.ajax({method:"GET",url:m.announcements}).done(function(n){if("object"!=("undefined"==typeof n?"undefined":_typeof(n)))return $(".fa-spinner").hide(),void e("GET method for "+m.announcements+" failed.");for(var t=n.announcements,o=n.announcements.length,a=o-1;a>-1;a--)d(t,a,0);$(".announcement-content-container").css({"text-align":"left"}),$(".fa-spinner").hide()}).fail(function(n){$(".announcement-content-container").css({"text-align":"left"}),$(".fa-spinner").hide(),e("GET method for "+m.announcements+" failed.")})}function t(e){$("#announcement-form").submit(function(n){var t=new Date,o=$(".form-announ #post-announcement").attr("data-login");return o?($.ajax({type:"POST",url:m.postAnnouncement,data:{officer:n.target.officer.value,timestamp:t,announcement:n.target.announcement.value}}).done(function(e){console.log("Announcement post successful!"),d(e.announcements,e.announcements.length-1,1)}).fail(function(n){e("Announcement "+m.postAnnouncement+" POST unsuccessful.")}),!1):(alert("Access Denied. How did you get here? You're not supposed to be here!"),e("Announcement post unsuccessful, not authenciated"),!1)})}function o(e){$.ajax({method:"GET",url:m.officers}).done(function(n){if("object"!=("undefined"==typeof n?"undefined":_typeof(n)))return void e("GET method for "+m.officers+" failed. Unsupported return type.");for(var t=0,o=n.length;t<o;t++)$("select").append('<option value="'+n[t].name+'">'+n[t].name+"</option>")}).fail(function(n){e("GET method for "+m.officers+" failed.")})}function a(e){localStorage.getItem("credentials")&&$.ajax({method:"GET",url:m.officerLogin+"?credentials="+localStorage.getItem("credentials")}).done(function(n){return void 0===n?void e(m.officerLogin+" returned, unauthenticated error"):n.indexOf("404")>=0?void e(m.officerLogin+" returned, unauthenticated error"):void("OK"==n&&($(".post-announcement").css({display:"flex"}),$(".announcement-container").css({height:"250px"}),$(".show-login").empty(),$(".form-announ #post-announcement").attr("data-login",!0)))}).fail(function(){e(m.officerLogin+" returned, unauthenticated error")})}function i(e,n){var t=this,o=e.target.name.value,a=e.target.password.value;endcodedCredentials=btoa(o+":"+a),$.ajax({type:"POST",url:m.login,headers:{authorization:"Basic "+endcodedCredentials},json:!0,dataType:"json"}).done(function(e){var n=e.uuid;$(".form-announ #post-announcement").attr("data-login",!0),console.log("Login successful with UUID "+n),localStorage.setItem("credentials",n),$(".mes").hide(),$(t).find(".custom-button").text("Success!").css({background:"green"}),$(".post-announcement").show(),$(".announcement-container").css({height:"275px"}),setTimeout(function(){$(t).find(".custom-button").text("Login").css({background:"#337ab7"}),$(".close-modal").click()},1500)}).fail(function(e){$(t).find(".custom-button").text("Failure").css({background:"#D8000C"}),setTimeout(function(){$(t).find(".custom-button").text("Login").css({background:"#0137A2"}),$(".mes").show()},2500),n("Login unsuccessful.. Error Code: "+JSON.stringify(e))})}function r(e){var n=$("#subscribe-email").val();s(n)?($("#stat").css({color:"green"}),$("#stat").text("Subscription successful!"),$.ajax({type:"POST",url:m.subscribe,data:{name:"new user",email:n,phone:"n/a",category:"SHPE Austin: Newletter Subscription Request",message:"Please add "+n+" to the newsletter.",subscribe:!0}}).done(function(e){console.log("Success!")}).fail(function(n){e(n)}),setTimeout(function(){$("#subscribe-container").css({display:"none"}),$("#newsletter-buttons").show(),$(".fa-archive").show(),$(".fa-envelope").show(),$("#stat").text("Subscribe to our newsletter!"),$("#stat").css({color:"black"})},2500)):($("#stat").css({color:"red"}),$("#stat").text("Invalid e-mail."))}function s(e){var n=/(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/;return n.test(e)}function c(e){var n=[],t=e.substring(0,e.indexOf("-"));e=e.substring(e.indexOf("-")+1,e.length);var o=e.substring(0,e.indexOf("-"));if(o=u(o),e=e.substring(e.indexOf("-")+1,e.length),day=e.substring(0,2),e.length>2){var a=e.substring(3,e.length),i=a.substring(0,5),r=parseInt(i);if(r>=12){if(r>12){var s=i.substring(2,i.length),c=parseInt(i.substring(0,2))-12;c/10<1&&(c=c.pad(2)),i=c+s}r="PM"}else r="AM";n.startTime=i+" "+r}else n.startTime="";return n.month=o,n.day=day,n.year=t,n}function u(e){switch(e=parseInt(e.replace(/^0+/,""))){case 1:return"January";case 2:return"February";case 3:return"March";case 4:return"April";case 5:return"May";case 6:return"June";case 7:return"July";case 8:return"August";case 9:return"September";case 10:return"October";case 11:return"November";case 12:return"December";default:return"Invalid Month"}}function l(e,n,t,o){return""===o&&(o="12:00 PM"),e=f.indexOf(e)+1,e/10<1&&(e=e.pad(2)),e+"/"+n+"/"+t+" "+o}function d(e,n,t){"undefined"==typeof n&&(n=e.length-1);var o='<p class="officer-post"> <span class="post-info"></span> <span class="post-content"></span></p>',a=e[n].officer,i=e[n].timestamp,r=e[n].announcement,s=new Date(i),c=s.toLocaleDateString(),u=s.toLocaleTimeString(),l=a+" ("+c+" @ "+u+")",d=$(o).find(".post-info")[0];$(d).text(l+" ");var f,m=$(o).find(".post-content")[0];if(new RegExp("([a-zA-Z0-9]+://)?([a-zA-Z0-9_]+:[a-zA-Z0-9_]+@)?([a-zA-Z0-9.-]+\\.[A-Za-z]{2,4})(:[0-9]+)?(/.*)?").test(r))for(var p=r.split(" "),h=0,g=p.length;h<g;h++)new RegExp("([a-zA-Z0-9]+://)?([a-zA-Z0-9_]+:[a-zA-Z0-9_]+@)?([a-zA-Z0-9.-]+\\.[A-Za-z]{2,4})(:[0-9]+)?(/.*)?").test(p[h])&&(f=document.createElement("a"),f.setAttribute("href",p[h]),f.text="(Attached link)");r=r.replace(/\n/g,"<br /><br />"),$(m).html(r+" "),$(m).append(f);var b='<p class="officer-post">',v=b;v=$(v).append(d),v=$(v).append(m),0===t?$(".announcement-content-container").append(v):1===t&&$(".announcement-content-container").prepend(v)}var f=["January","February","March","April","May","June","July","August","September","October","November","December"],m={calendar:"/data/calendar",announcements:"/data/announcements",officers:"/data/officerList",officerLogin:"/data/officerlogin",postAnnouncement:"/update/announcements",login:"/authentication/login",subscribe:"/communication/contact"};return{getCalendarData:e,getAnnouncements:n,postAnnouncement:t,getOfficers:o,getAuthentication:a,login:i,subscribe:r,_parseCalendarTime:c,_convertToDateFormat:l}}(),modal=function(){var e,n,t,o,a={};return a.initialize=function(a){console.log("Initializing modal..."),e=a.$content,n=a.$close,t=a.$overlay,o=a.$modal},a.center=function(){var e,n;e=Math.max($(window).height()-o.outerHeight(),0)/2,n=Math.max($(window).width()-o.outerWidth(),0)/2,o.css({top:e+$(window).scrollTop(),left:n+$(window).scrollLeft()})},a.open=function(n){e.empty().append(n.content),o.css({width:n.width-10||"auto",height:n.height-10||"auto","text-align":n.align}),e.css({width:n.width||"auto",height:n.height||"auto"}),a.center(),$(window).bind("resize.modal",a.center),o.show(),t.show()},a.close=function(){o.hide(),t.hide(),e.empty(),$(window).unbind("resize.modal")},$(document).keydown(function(e){27==e.keyCode&&$("#close").click()}),a}();