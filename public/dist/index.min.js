$(document).ready(function(){function e(e,t,n){var a='<p class="officer-post"> <span class="post-info"></span> <span class="post-content"></span></p>',r=e[t].officer,o=e[t].timestamp,i=e[t].announcement,s=new Date(o),l=s.toLocaleDateString(),c=s.toLocaleTimeString(),d=r+" ("+l+" @ "+c+")",u=$(a).find(".post-info")[0];$(u).text(d+" ");var m=$(a).find(".post-content")[0];new RegExp("([a-zA-Z0-9]+://)?([a-zA-Z0-9_]+:[a-zA-Z0-9_]+@)?([a-zA-Z0-9.-]+\\.[A-Za-z]{2,4})(:[0-9]+)?(/.*)?").test(i)&&console.log("Contains URL"),$(m).text(i);var p='<p class="officer-post">',h=p;h=$(h).append(u),h=$(h).append(m),0===n?$(".announcement-content-container").append(h):1===n&&$(".announcement-content-container").prepend(h)}function t(e,t,n,a){return""==a&&(a="12:00 PM"),e=h.indexOf(e)+1,1>e/10&&(e=e.pad(2)),e+"/"+t+"/"+n+" "+a}function n(e){var t=[],n=e.substring(0,e.indexOf("-"));e=e.substring(e.indexOf("-")+1,e.length);var r=e.substring(0,e.indexOf("-"));if(r=a(r),e=e.substring(e.indexOf("-")+1,e.length),day=e.substring(0,2),e.length>2){var o=e.substring(3,e.length),i=o.substring(0,5),s=parseInt(i);if(s>=12){if(s>12){var l=i.substring(2,i.length),c=parseInt(i.substring(0,2))-12;1>c/10&&(c=c.pad(2)),i=c+l}s="PM"}else s="AM";t.startTime=i+" "+s}else t.startTime="";return t.month=r,t.day=day,t.year=n,t}function a(e){switch(e=parseInt(e.replace(/^0+/,""))){case 1:return"January";case 2:return"February";case 3:return"March";case 4:return"April";case 5:return"May";case 6:return"June";case 7:return"July";case 8:return"August";case 9:return"September";case 10:return"October";case 11:return"November";case 12:return"December";default:return"Invalid Month"}}function r(){$("#title").empty(),$("#description").empty(),c>l&&($($("ol li")[l]).addClass("active"),$("#title").append(o.newsletter[l].title),$("#description").append("<span class = 'bold'> Description: </span>"+o.newsletter[l].description),$("#image-newsletter").attr("src","../assets/newsletter/newsletter"+l),$("#image-newsletter").parent()[0].setAttribute("href",o.newsletter[l].image_link),o.newsletter[l].image_link?$("#image-newsletter").parent()[0].setAttribute("onclick","return true;"):$("#image-newsletter").parent()[0].setAttribute("onclick","return false;"))}var o,i,s,l=0,c=0,d=0,u=0,m=!1,p=setInterval(function(e){$("#next-newsletter").click()},5e3);$.ajax({method:"GET",url:"/newsletterdata"}).done(function(e){o=e,c=e.newsletter.length;for(var t=1;c>t;t++){var n=document.createElement("li");$(".carousel-indicators").append(n)}$($("ol li")[l]).addClass("active"),$("#title").append(e.newsletter[l].title),$("#description").append("<span class = 'bold'> Description: </span>"+e.newsletter[l].description),$("#image-newsletter").attr("src","../assets/newsletter/newsletter0");var a=document.createElement("a");a.href=e.newsletter[l].image_link,$("#image-newsletter").wrap(a),e.newsletter[l].image_link?$("#image-newsletter").parent()[0].setAttribute("onclick","return true;"):$("#image-newsletter").parent()[0].setAttribute("onclick","return false;")}).fail(function(e){console.error("GET method for /newsletterdata failed.")}),$.ajax({method:"GET",url:"/calendardata"}).done(function(e){i=e,d=i.calendar.length;var a=!1,r=new Date;for(r.getMonth(),r.getDate();a===!1;){calendarHtml=i.calendar[u],$("#event-title").html("<b>Event: </b>"+calendarHtml.event),$("span.title").text(calendarHtml.event);var o=n(calendarHtml.time);if(o.startTime){$("#event-date").html("<b>Date: </b>"+o.month+" "+o.day+", "+o.year+" at "+o.startTime);var s=t(o.month,o.day,o.year,o.startTime);$("span.start").text(s),$("span.end").text(s)}else{$("#event-date").html("<b>Date: </b>"+o.month+" "+o.day+", "+o.year);var s=t(o.month,o.day,o.year,"");$("span.start").text(s),$("span.end").text(s)}o.day<r.getDate()?(i.calendar.splice(0,1),d--):(a=!0,calendarHtml.location?($("#event-location").html("<b>Location: </b>"+calendarHtml.location),$("span.location").text(calendarHtml.location)):$("span.location").text(""),$("#event-link").attr("href",calendarHtml.link),$("span.description").text(calendarHtml.link))}}),$.ajax({method:"GET",url:"/announcements"}).done(function(t){var n=t.announcements;s=t.announcements.length;for(var a=s-1;a>-1;a--)e(n,a,0);console.log("Success!!"),$(".announcement-content-container").css({"text-align":"left"}),$(".fa-spinner").hide()}).fail(function(e){$(".announcement-content-container").css({"text-align":"left"}),$(".fa-spinner").hide(),console.error("GET method for /announcements failed.")}),$(".cal-button").on("click",function(e){$(e.currentTarget).hasClass("fa-angle-double-right")?u=(u+1)%d:(u--,0>u&&(u=d-1)),$(".fa-calendar").toggleClass("dark-shpe-blue mid-blue"),calendarHtml=i.calendar[u],$("#event-title").html("<b>Event: </b>"+calendarHtml.event),$("span.title").text(calendarHtml.event);var a=n(calendarHtml.time);if(a.startTime){$("#event-date").html("<b>Date: </b>"+a.month+" "+a.day+", "+a.year+" at "+a.startTime);var r=t(a.month,a.day,a.year,a.startTime);$("span.start").text(r),$("span.end").text(r)}else{$("#event-date").html("<b>Date: </b>"+a.month+" "+a.day+", "+a.year);var r=t(a.month,a.day,a.year,a.startTime,"");$("span.start").text(r),$("span.end").text(r)}calendarHtml.location?($("#event-location").html("<b>Location: </b>"+calendarHtml.location),$("span.location").text(calendarHtml.location)):($("#event-location").html(""),$("span.location").text("")),$("#event-link").attr("href",calendarHtml.link),$("span.description").text(calendarHtml.link)});var h=["January","February","March","April","May","June","July","August","September","October","November","December"];$("#prev-newsletter").click(function(e){e.originalEvent&&clearInterval(p),$($("ol li")[l]).removeClass("active"),0===l?l=c-1:l--,r()}),$("#next-newsletter").click(function(e){e.originalEvent&&clearInterval(p),$($("ol li")[l]).removeClass("active"),l=(l+1)%c,r()});var f=/Android|iPhone|iPad|iPod/i.test(navigator.userAgent);f&&$(".show-login").empty(),$("#login-form").submit(function(e){return $.ajax({type:"POST",url:"/login",data:{username:e.target.name.value,password:e.target.password.value}}).done(function(e){console.log("Login successful!"),$(".status").text("Login successful!").css({color:"#4CAF50"}).show(),$(".post-announcement").show(),$(".announcement-container").css({height:"315px"}),m=!0,setTimeout(function(){$(".status").hide(),$(".close-modal").click()},1500)}).fail(function(e){$(".status").text("Login unsuccessful.").css({color:"#F44336"}).show(),setTimeout(function(){$(".status").hide()},2500),console.error("Login unsuccessful.. Error Code: "+JSON.stringify(e))}),!1}),$("#announcement-form").submit(function(t){var n=new Date;return m?($.ajax({type:"POST",url:"/announcements",data:{officer:t.target.officer.value,timestamp:n,announcement:t.target.announcement.value}}).done(function(t){console.log("Announcement post successful!"),e(t.announcements,s,1),s++}).fail(function(e){console.error("Announcement post unsuccessful.")}),!1):(alert("Access Denied. How did you get here? You're not supposed to be here!"),!1)}),Number.prototype.pad=function(e){return new Array(e).join("0").slice(-1*(e||2))+this}});var modal=function(){var e={},t=$('<div id="overlay"></div>');return $modal=$('<div id="modal"></div>'),$content=$('<div id="content"></div>'),$close=$('<a id="close" href="#">close</a>'),$modal.hide(),t.hide(),$modal.append($content,$close),e.center=function(){var e,t;e=Math.max($(window).height()-$modal.outerHeight(),0)/2,t=Math.max($(window).width()-$modal.outerWidth(),0)/2,$modal.css({top:e+$(window).scrollTop(),left:t+$(window).scrollLeft()})},e.open=function(n){$content.empty().append(n.content),$modal.css({width:n.width-10||"auto",height:n.height-10||"auto","text-align":n.align}),$content.css({width:n.width||"auto",height:n.height||"auto"}),e.center(),$(window).bind("resize.modal",e.center),$modal.show(),t.show()},e.close=function(){$modal.hide(),t.hide(),$content.empty(),$(window).unbind("resize.modal")},$(document).ready(function(){$("body").append(t,$modal),$close.click(function(t){t.preventDefault(),e.close()}),$(".fa-archive").click(function(){var e=400,t=500;window_height=$(window).height(),window_width=$(window).width(),e=window_height<e?window_height-50:e,t=window_width<t?window_width-50:t,$("#modal").css({background:"white"}),modal.open({content:$("<h1>View Previous Newsletters<h1><ul><li><a href='http://us1.campaign-archive2.com/?u=c8b5a41c875ce918bbd091e52&id=17cac73925&e=38ee20bb08'>April 2016</a></li><li><a href='http://us1.campaign-archive2.com/?u=c8b5a41c875ce918bbd091e52&id=a8f7a3cd22&e=38ee20bb08'>March 2016 </a></li><li><a href='http://us1.campaign-archive2.com/?u=c8b5a41c875ce918bbd091e52&id=ecb6bb1b8c&e=1365fed48c'>February 2016</a> </li></ul>"),width:t+"px",height:e+"px",align:"center"})}),$(document).keydown(function(e){27==e.keyCode&&$("#close").click()})}),e}();