$(document).ready(function(){function e(e){var t=/(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/;return t.test(e)}function t(e,t,n){var a='<p class="officer-post"> <span class="post-info"></span> <span class="post-content"></span></p>',o=e[t].officer,r=e[t].timestamp,i=e[t].announcement,s=new Date(r),c=s.toLocaleDateString(),l=s.toLocaleTimeString(),d=o+" ("+c+" @ "+l+")",u=$(a).find(".post-info")[0];$(u).text(d+" ");var m=$(a).find(".post-content")[0];new RegExp("([a-zA-Z0-9]+://)?([a-zA-Z0-9_]+:[a-zA-Z0-9_]+@)?([a-zA-Z0-9.-]+\\.[A-Za-z]{2,4})(:[0-9]+)?(/.*)?").test(i),$(m).text(i);var p='<p class="officer-post">',h=p;h=$(h).append(u),h=$(h).append(m),0===n?$(".announcement-content-container").append(h):1===n&&$(".announcement-content-container").prepend(h)}function n(e,t,n,a){return""===a&&(a="12:00 PM"),e=g.indexOf(e)+1,1>e/10&&(e=e.pad(2)),e+"/"+t+"/"+n+" "+a}function a(e){var t=[],n=e.substring(0,e.indexOf("-"));e=e.substring(e.indexOf("-")+1,e.length);var a=e.substring(0,e.indexOf("-"));if(a=o(a),e=e.substring(e.indexOf("-")+1,e.length),day=e.substring(0,2),e.length>2){var r=e.substring(3,e.length),i=r.substring(0,5),s=parseInt(i);if(s>=12){if(s>12){var c=i.substring(2,i.length),l=parseInt(i.substring(0,2))-12;1>l/10&&(l=l.pad(2)),i=l+c}s="PM"}else s="AM";t.startTime=i+" "+s}else t.startTime="";return t.month=a,t.day=day,t.year=n,t}function o(e){switch(e=parseInt(e.replace(/^0+/,""))){case 1:return"January";case 2:return"February";case 3:return"March";case 4:return"April";case 5:return"May";case 6:return"June";case 7:return"July";case 8:return"August";case 9:return"September";case 10:return"October";case 11:return"November";case 12:return"December";default:return"Invalid Month"}}function r(){$("#title").empty(),$("#description").empty(),m>u&&($($("ol li")[u]).addClass("active"),$("#title").append(i.newsletter[u].title),$("#description").append("<span class = 'bold'> Description: </span>"+i.newsletter[u].description),$("#image-newsletter").attr("src","../assets/newsletter/newsletter"+u+"?v="+l),$("#image-newsletter").parent()[0].setAttribute("href",i.newsletter[u].image_link),i.newsletter[u].image_link?$("#image-newsletter").parent()[0].setAttribute("onclick","return true;"):$("#image-newsletter").parent()[0].setAttribute("onclick","return false;"))}var i,s,c,l,d=io(),u=0,m=0,p=0,h=0,f=!1;d.emit("revision","Get revision number from backend."),d.on("revision",function(e){l=e});var b=setInterval(function(e){$("#next-newsletter").click()},5e3);$.ajax({method:"GET",url:"/newsletterdata"}).done(function(e){i=e,m=e.newsletter.length;for(var t=1;m>t;t++){var n=document.createElement("li");$(".carousel-indicators").append(n)}$($("ol li")[u]).addClass("active"),$("#title").append(e.newsletter[u].title),$("#description").append("<span class = 'bold'> Description: </span>"+e.newsletter[u].description),$("#image-newsletter").attr("src","../assets/newsletter/newsletter0?v="+l);var a=document.createElement("a");a.href=e.newsletter[u].image_link,$("#image-newsletter").wrap(a),e.newsletter[u].image_link?$("#image-newsletter").parent()[0].setAttribute("onclick","return true;"):$("#image-newsletter").parent()[0].setAttribute("onclick","return false;")}).fail(function(e){console.error("GET method for /newsletterdata failed.")}),$.ajax({method:"GET",url:"/calendardata"}).done(function(e){s=e,p=s.calendar.length;var t,o=!1,r=new Date;for(r.getMonth(),r.getDate();o===!1;){calendarHtml=s.calendar[h],$("#event-title").html("<b>Event: </b>"+calendarHtml.event),$("span.title").text(calendarHtml.event);var i=a(calendarHtml.time);i.startTime?($("#event-date").html("<b>Date: </b>"+i.month+" "+i.day+", "+i.year+" at "+i.startTime),t=n(i.month,i.day,i.year,i.startTime),$("span.start").text(t),$("span.end").text(t)):($("#event-date").html("<b>Date: </b>"+i.month+" "+i.day+", "+i.year),t=n(i.month,i.day,i.year,""),$("span.start").text(t),$("span.end").text(t)),i.day<r.getDate()?(s.calendar.splice(0,1),p--):(o=!0,calendarHtml.location?($("#event-location").html("<b>Location: </b>"+calendarHtml.location),$("span.location").text(calendarHtml.location)):$("span.location").text(""),$("#event-link").attr("href",calendarHtml.link),$("span.description").text(calendarHtml.link))}}),$.ajax({method:"GET",url:"/announcements"}).done(function(e){var n=e.announcements;c=e.announcements.length;for(var a=c-1;a>-1;a--)t(n,a,0);$(".announcement-content-container").css({"text-align":"left"}),$(".fa-spinner").hide()}).fail(function(e){$(".announcement-content-container").css({"text-align":"left"}),$(".fa-spinner").hide(),console.error("GET method for /announcements failed.")}),localStorage.getItem("credentials")&&$.ajax({method:"GET",url:"/officerlogin?credentials="+localStorage.getItem("credentials")}).done(function(e){void 0!==e&&"OK"==e&&($(".post-announcement").css({display:"flex"}),$(".announcement-container").css({height:"250px"}),$(".show-login").empty(),f=!0)}).fail(function(){console.error("/officerlogin endpoint failed")}),$(".fa-envelope").click(function(){$("#subscribe-container").css({display:"flex"}),$("#newsletter-buttons").hide(),$(".fa-archive").hide(),$(this).hide(),clearInterval(b)}),$(".fa-envelope-o").click(function(t){var n=$("#subscribe-email").val();e(n)?($("#stat").css({color:"green"}),$("#stat").text("Subscription successful!"),$.ajax({type:"POST",url:"/contact",data:{name:"new user",email:n,phone:"n/a",category:"SHPE Austin: Newletter Subscription Request",message:"Please add "+n+" to the newsletter."}}).done(function(e){console.log("Success!")}).fail(function(e){console.error("Unsuccessful. Error Code: "+e)}),setTimeout(function(){$("#subscribe-container").css({display:"none"}),$("#newsletter-buttons").show(),$(".fa-archive").show(),$(".fa-envelope").show(),$("#stat").text("Subscribe to our newsletter!"),$("#stat").css({color:"black"})},2500)):($("#stat").css({color:"red"}),$("#stat").text("Invalid e-mail."))}),$(".cal-button").on("click",function(e){$(e.currentTarget).hasClass("fa-angle-double-right")?h=(h+1)%p:(h--,0>h&&(h=p-1)),$(".fa-calendar").toggleClass("dark-shpe-blue mid-blue"),calendarHtml=s.calendar[h],$("#event-title").html("<b>Event: </b>"+calendarHtml.event),$("span.title").text(calendarHtml.event);var t,o=a(calendarHtml.time);o.startTime?($("#event-date").html("<b>Date: </b>"+o.month+" "+o.day+", "+o.year+" at "+o.startTime),t=n(o.month,o.day,o.year,o.startTime),$("span.start").text(t),$("span.end").text(t)):($("#event-date").html("<b>Date: </b>"+o.month+" "+o.day+", "+o.year),t=n(o.month,o.day,o.year,o.startTime,""),$("span.start").text(t),$("span.end").text(t)),calendarHtml.location?($("#event-location").html("<b>Location: </b>"+calendarHtml.location),$("span.location").text(calendarHtml.location)):($("#event-location").html(""),$("span.location").text("")),$("#event-link").attr("href",calendarHtml.link),$("span.description").text(calendarHtml.link)});var g=["January","February","March","April","May","June","July","August","September","October","November","December"];$("#prev-newsletter").click(function(e){e.originalEvent&&clearInterval(b),$($("ol li")[u]).removeClass("active"),0===u?u=m-1:u--,r()}),$("#next-newsletter").click(function(e){e.originalEvent&&clearInterval(b),$($("ol li")[u]).removeClass("active"),u=(u+1)%m,r()}),$("#close-subscribe").click(function(){$("#subscribe-container").css({display:"none"}),$("#newsletter-buttons").show(),$(".fa-archive").show(),$(".fa-envelope").show(),$("#stat").text("Subscribe to our newsletter!"),$("#stat").css({color:"black"})});var w=/Android|iPhone|iPad|iPod/i.test(navigator.userAgent);w&&$(".show-login").empty(),$("#login-form").submit(function(e){return $.ajax({type:"POST",url:"/login",data:{username:e.target.name.value,password:e.target.password.value}}).done(function(e){var t=e.uuid;console.log("Login successful with UUID "+t),localStorage.setItem("credentials",t),$(".mes").hide(),$(".status").text("Login successful!").css({color:"#4CAF50"}).show(),$(".post-announcement").show(),$(".announcement-container").css({height:"275px"}),setTimeout(function(){$(".status").hide(),$(".close-modal").click()},1500)}).fail(function(e){$(".status").text("Login unsuccessful.").css({color:"#F44336"}).show(),setTimeout(function(){$(".status").hide(),$(".mes").show()},2500),console.error("Login unsuccessful.. Error Code: "+JSON.stringify(e))}),!1}),$("#announcement-form").submit(function(e){var n=new Date;return f?($.ajax({type:"POST",url:"/announcements",data:{officer:e.target.officer.value,timestamp:n,announcement:e.target.announcement.value}}).done(function(e){console.log("Announcement post successful!"),t(e.announcements,c,1),c++}).fail(function(e){console.error("Announcement post unsuccessful.")}),!1):(alert("Access Denied. How did you get here? You're not supposed to be here!"),!1)}),Number.prototype.pad=function(e){return new Array(e).join("0").slice(-1*(e||2))+this}});var modal=function(){var e={},t=$('<div id="overlay"></div>');return $modal=$('<div id="modal"></div>'),$content=$('<div id="modal-content"></div>'),$close=$('<a id="close" href="#">close</a>'),$modal.hide(),t.hide(),$modal.append($content,$close),e.center=function(){var e,t;e=Math.max($("body").height()-$modal.outerHeight(),0)/2,t=Math.max($("body").width()-$modal.outerWidth(),0)/2,$modal.css({top:e+$(window).scrollTop(),left:t+$(window).scrollLeft()})},e.open=function(n){$content.empty().append(n.content),$modal.css({width:n.width-10||"auto",height:n.height-10||"auto","text-align":n.align}),$content.css({width:n.width||"auto",height:n.height||"auto"}),e.center(),$(window).bind("resize.modal",e.center),$modal.show(),t.show()},e.close=function(){$modal.hide(),t.hide(),$content.empty(),$(window).unbind("resize.modal")},$(document).ready(function(){$(".main-page-container").append(t,$modal),$close.click(function(t){t.preventDefault(),e.close()}),$(".fa-archive").click(function(){var e=400,t=500;window_height=$(window).height(),window_width=$(window).width(),e=window_height<e?window_height-50:e,t=window_width<t?window_width-50:t,$("#modal").css({background:"white"}),modal.open({content:$("<h1>View Previous Newsletters<h1><ul class='newsletterList'><li><a href='http://us1.campaign-archive1.com/?u=c8b5a41c875ce918bbd091e52&id=00399bbff9&e=38ee20bb08'>Early May 2016</a> </li><li><a href='http://us1.campaign-archive2.com/?u=c8b5a41c875ce918bbd091e52&id=480dcd7865&e=38ee20bb08'>Mid-April 2016</a> </li><li><a href='http://us1.campaign-archive2.com/?u=c8b5a41c875ce918bbd091e52&id=17cac73925&e=38ee20bb08'>Early-April 2016</a></li><li><a href='http://us1.campaign-archive2.com/?u=c8b5a41c875ce918bbd091e52&id=a8f7a3cd22&e=38ee20bb08'>March 2016 </a></li><li><a href='http://us1.campaign-archive2.com/?u=c8b5a41c875ce918bbd091e52&id=ecb6bb1b8c&e=1365fed48c'>February 2016</a></li></ul>"),width:t+"px",height:e+"px",align:"center"})}),$(document).keydown(function(e){27==e.keyCode&&$("#close").click()})}),e}();